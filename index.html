<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#10B981">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-title" content="CRRT Dose Calculator">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="CRRT Dose Calculator">
    
    <title>CRRT Dose Calculator</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="./css/crrt_calculator.css">
</head>
<body>
    <!-- Header -->
    <header class="app-header">
        <div class="container-fluid">
            <div class="row align-items-center">
                <div class="col-auto">
                    <button id="menuBtn" class="btn btn-link text-dark">
                        <span class="material-icons">menu</span>
                    </button>
                </div>
                <div class="col text-center">
                    <h1 class="app-title mb-0">CRRT Ïö©Îüâ Í≥ÑÏÇ∞Í∏∞</h1>
                    <p class="app-subtitle mb-0">Continuous Renal Replacement Therapy</p>
                </div>
                <div class="col-auto">
                    <!-- Í∞ÄÏù¥Îìú Î≤ÑÌäº Ï†úÍ±∞Îê® - ÏÇ¨Ïù¥ÎìúÎ∞î Î©îÎâ¥ÏóêÏÑú Ï†ëÍ∑º Í∞ÄÎä• -->
                </div>
            </div>
        </div>
    </header>

    <!-- Sidebar Menu -->
    <div id="sidebar" class="sidebar">
        <div class="sidebar-header">
            <h5>CRRT Í≥ÑÏÇ∞Í∏∞</h5>
            <button id="closeSidebar" class="btn-close"></button>
        </div>
        <div class="sidebar-content">
            <div class="list-group list-group-flush">
                <button class="list-group-item list-group-item-action" id="guideMenuItem">
                    <span class="material-icons">info</span>
                    Ï¥àÍ∏∞ ÏÑ§Ï†ï Í∞ÄÏù¥Îìú
                </button>

                <hr>
                <button class="list-group-item list-group-item-action" id="loadDataMenuItem">
                    <span class="material-icons">restore</span>
                    Ï†ÄÏû•Îêú Îç∞Ïù¥ÌÑ∞ Î°úÎìú
                </button>
                <button class="list-group-item list-group-item-action" id="settingsMenuItem">
                    <span class="material-icons">settings</span>
                    ÏÑ§Ï†ï
                </button>
                <hr>
                <button class="list-group-item list-group-item-action text-danger" id="clearDataMenuItem">
                    <span class="material-icons">delete</span>
                    Î™®Îì† Îç∞Ïù¥ÌÑ∞ Ï¥àÍ∏∞Ìôî
                </button>
            </div>
        </div>
    </div>
    <div id="sidebarOverlay" class="sidebar-overlay"></div>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container-fluid">
            <!-- Input Section -->
            <div class="row">
                <div class="col-12">
                    <div class="card input-card">
                        <div class="card-header">
                            <h5 class="mb-0">ÏûÖÎ†• Îç∞Ïù¥ÌÑ∞ (Input Data)</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <!-- Patient Data -->
                                <div class="col-md-6">
                                    <h6 class="section-title">ÌôòÏûê Îç∞Ïù¥ÌÑ∞ (Patient Data)</h6>
                                    <div class="mb-3">
                                        <label for="weight" class="form-label">Ï≤¥Ï§ë (Weight) <span class="text-muted">(kg)</span></label>
                                        <input type="number" class="form-control" id="weight" placeholder="Ï≤¥Ï§ëÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî" step="0.1" min="0">
                                    </div>
                                    <div class="mb-3">
                                        <label for="hematocrit" class="form-label">Ìó§ÎßàÌÜ†ÌÅ¨Î¶ø (Hematocrit) <span class="text-muted">(%)</span></label>
                                        <input type="number" class="form-control" id="hematocrit" placeholder="Ìó§ÎßàÌÜ†ÌÅ¨Î¶øÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî" step="0.1" min="0" max="100">
                                    </div>
                                </div>
                                
                                <!-- Prescription Data -->
                                <div class="col-md-6">
                                    <h6 class="section-title">Ï≤òÎ∞© Îç∞Ïù¥ÌÑ∞ (Prescription Data)</h6>
                                    <div class="mb-3">
                                        <label for="bloodFlowRate" class="form-label">ÌòàÎ•òÎüâ (Blood Flow Rate) <span class="text-muted">(mL/min)</span></label>
                                        <input type="number" class="form-control" id="bloodFlowRate" placeholder="ÌòàÎ•òÎüâÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî" step="1" min="0">
                                    </div>
                                    <div class="mb-3">
                                        <label for="preDilution" class="form-label">Ï†ÑÌù¨ÏÑù (Pre-dilution) <span class="text-muted">(mL/hr)</span></label>
                                        <input type="number" class="form-control" id="preDilution" placeholder="Ï†ÑÌù¨ÏÑùÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî" step="1" min="0">
                                    </div>
                                    <div class="mb-3">
                                        <label for="postDilution" class="form-label">ÌõÑÌù¨ÏÑù (Post-dilution) <span class="text-muted">(mL/hr)</span></label>
                                        <input type="number" class="form-control" id="postDilution" placeholder="ÌõÑÌù¨ÏÑùÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî" step="1" min="0">
                                    </div>
                                    <div class="mb-3">
                                        <label for="dialysate" class="form-label">Ìà¨ÏÑùÏï° (Dialysate) <span class="text-muted">(mL/hr)</span></label>
                                        <input type="number" class="form-control" id="dialysate" placeholder="Ìà¨ÏÑùÏï°ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî" step="1" min="0">
                                    </div>
                                    <div class="mb-3">
                                        <label for="ultraFiltration" class="form-label">Ï¥àÍ≥ºÏó¨Í≥º (Ultra-filtration) <span class="text-muted">(mL/hr)</span></label>
                                        <input type="number" class="form-control" id="ultraFiltration" placeholder="Ï¥àÍ≥ºÏó¨Í≥ºÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî" step="1" min="0">
                                    </div>
                                    <div class="mb-3">
                                        <label for="prescribedTime" class="form-label">Ï≤òÎ∞©ÏãúÍ∞Ñ (Prescribed Time) <span class="text-muted">(hr)</span></label>
                                        <input type="number" class="form-control" id="prescribedTime" placeholder="Ï≤òÎ∞©ÏãúÍ∞ÑÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî" step="0.5" min="0">
                                    </div>
                                    <div class="mb-3">
                                        <label for="actualRuntime" class="form-label">Ïã§Ï†úÏö¥ÌñâÏãúÍ∞Ñ (Actual Runtime) <span class="text-muted">(hr)</span></label>
                                        <input type="number" class="form-control" id="actualRuntime" placeholder="Ïã§Ï†úÏö¥ÌñâÏãúÍ∞ÑÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî" step="0.5" min="0">
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Action Buttons -->
                            <div class="row mt-3">
                                <div class="col-12 text-center">
                                    <button id="calculateBtn" class="btn btn-primary btn-lg me-2">
                                        <span class="material-icons">calculate</span>
                                        Í≥ÑÏÇ∞ÌïòÍ∏∞ (Calculate)
                                    </button>
                                    <button id="clearBtn" class="btn btn-outline-secondary btn-lg me-2">
                                        <span class="material-icons">clear</span>
                                        Ï¥àÍ∏∞Ìôî (Clear)
                                    </button>
                                    <button id="saveBtn" class="btn btn-success btn-lg">
                                        <span class="material-icons">save</span>
                                        Ï†ÄÏû• (Save)
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Results Section -->
            <div class="row mt-4" id="resultsSection" style="display: none;">
                <div class="col-12">
                    <div class="card results-card">
                        <div class="card-header">
                            <h5 class="mb-0">Í≥ÑÏÇ∞ Í≤∞Í≥º (Calculation Results)</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="result-item">
                                        <h6>ÌòàÏû• Ïú†Îüâ (Plasma Flow)</h6>
                                        <div class="result-value" id="plasmaFlowResult">-</div>
                                        <small class="text-muted">mL/hr</small>
                                    </div>
                                    <div class="result-item">
                                        <h6>Ï≤òÎ∞© Ïö©Îüâ (Prescribed Dose)</h6>
                                        <div class="result-value" id="effluentDoseResult">-</div>
                                        <small class="text-muted">mL/kg/hr</small>
                                    </div>
                                    <div class="result-item">
                                        <h6>Ïó¨Í≥ºÎ∂ÑÏú® (Filtration Fraction)</h6>
                                        <div class="result-value" id="filtrationFractionResult">-</div>
                                        <small class="text-muted">%</small>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="result-item">
                                        <h6>Ìù¨ÏÑùÏù∏Ïûê (Dilution Factor)</h6>
                                        <div class="result-value" id="dilutionFactorResult">-</div>
                                        <small class="text-muted">-</small>
                                    </div>
                                    <div class="result-item">
                                        <h6>Ïã§Ï†ú Ï†ÑÎã¨ Ïö©Îüâ (Actual Delivered Dose)</h6>
                                        <div class="result-value" id="actualDeliveredDoseResult">-</div>
                                        <small class="text-muted">mL/kg/hr</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Calculation Steps Section -->
            <div class="row mt-4" id="calculationStepsSection" style="display: none;">
                <div class="col-12">
                    <div class="card steps-card">
                        <div class="card-header">
                            <h5 class="mb-0">Í≥ÑÏÇ∞ Í≥ºÏ†ï (Calculation Steps)</h5>
                        </div>
                        <div class="card-body">
                            <div id="calculationStepsContent">
                                <!-- Calculation steps will be populated here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Warnings Section -->
            <div class="row mt-4" id="warningsSection" style="display: none;">
                <div class="col-12">
                    <div class="card warnings-card">
                        <div class="card-header">
                            <h5 class="mb-0">Í≤ΩÍ≥† Î∞è ÏïåÎ¶º (Warnings & Alerts)</h5>
                        </div>
                        <div class="card-body">
                            <!-- Warnings will be populated here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Dilution Factor Interpretation Section -->
            <div class="row mt-4" id="dilutionFactorInterpretationSection" style="display: none;">
                <div class="col-12">
                    <div class="card interpretation-card">
                        <div class="card-header">
                            <h5 class="mb-0">Ìù¨ÏÑùÏù∏Ïûê Ìï¥ÏÑù (Dilution Factor Interpretation)</h5>
                        </div>
                        <div class="card-body">
                            <!-- Dilution factor interpretation will be populated here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recommended Ranges Section -->
            <div class="row mt-4" id="recommendedRangesSection" style="display: none;">
                <div class="col-12">
                    <div class="card ranges-card">
                        <div class="card-header">
                            <h5 class="mb-0">Í∂åÏû• Î≤îÏúÑ (Recommended Ranges)</h5>
                        </div>
                        <div class="card-body">
                            <!-- Recommended ranges will be populated here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Guide Modal -->
    <div class="modal fade" id="guideModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Ï¥àÍ∏∞ ÏÑ§Ï†ï Í∞ÄÏù¥Îìú (Initial Setup Guide)</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-info">
                        <h6>üí° ÏÑ†ÌÉù ÏïàÎÇ¥ (Selection Guide)</h6>
                        <ul class="mb-0">
                            <li>ÏÑ†ÌÉùÌïú Í∞íÏù¥ Í≥ÑÏÇ∞Í∏∞Ïóê ÏûêÎèô Ï†ÅÏö©Îê©ÎãàÎã§</li>
                            <li>Ï≤¥Ï§ëÏùÄ Î≤îÏúÑÏùò Ï§ëÍ∞ÑÍ∞íÏù¥ ÏÑ†ÌÉùÎê©ÎãàÎã§</li>
                            <li>Hct 30%, UF 50, ÏãúÍ∞Ñ 24/20hr ÏûêÎèô ÏÑ§Ï†ï</li>
                        </ul>
                    </div>
                    
                    <div class="table-responsive">
                        <table class="table table-bordered table-hover" id="guideTable">
                            <thead class="table-primary">
                                <tr>
                                    <th>Ï≤¥Ï§ë(kg) (Weight)</th>
                                    <th>ÌòàÎ•òÎüâ (Blood flow, mL/min)</th>
                                    <th>Ï†ÑÌù¨ÏÑù (Pre, mL/h)</th>
                                    <th>ÌõÑÌù¨ÏÑù (Post, mL/h)</th>
                                    <th>Ìà¨ÏÑùÏï° (Dialysate rate, mL/h)</th>
                                    <th>ÏÑ†ÌÉù (Select)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Guide table rows will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal fade" id="settingsModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">ÏÑ§Ï†ï (Settings)</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" id="autoSaveSwitch" checked>
                        <label class="form-check-label" for="autoSaveSwitch">
                            ÏûêÎèô Ï†ÄÏû• (Auto Save)
                        </label>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Load Data Modal -->
    <div class="modal fade" id="loadDataModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Ï†ÄÏû•Îêú Îç∞Ïù¥ÌÑ∞ Î°úÎìú (Load Saved Data)</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div id="savedDataContent">
                        <!-- Saved data will be displayed here -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" id="loadDataBtn">Îç∞Ïù¥ÌÑ∞ Î°úÎìú (Load Data)</button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Îã´Í∏∞ (Close)</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom JS -->
    <script src="./js/crrt_calculator.js"></script>
</body>
</html>
